\section{Лекция 27 (12.04)}

\subsection{Моделирование граничных условий на стенке методом конечных объёмов с использованием пристеночной функции}

Рассмотрим задачу вязкого несжимаего течения около стенки.
Удельная сила трения на стенке запишется в виде

\begin{equation}
\label{tauw}
\tau_w = -\left.\nu\dfr{u}{n}\right|_{\gamma},
\end{equation}
$u$ здесь -- касательная к стенке компонента вектора скорости.

Здесь и далее используются безразмерные величины: $\rho=1$, $\nu = \Ren^{-1}$.
Плотность в выкладках будет опускаться.
Характерная скорость в пограничном слое примет вид
\begin{equation}
\label{utau}
u_\tau = \sqrt{\left|\tau_w\right|}.
\end{equation}
Тогда запишем нормированные скорость и расстоние поперёк пограничного слоя:
\begin{equation}
\label{uy_plus}
u^{+} = \frac{u - u_\gamma}{u_\tau}, \quad y^{+} = \frac{y u_\tau}{\nu}
\end{equation}

При аппроксимации формулы \cref{tauw} производная справа будет расписана в виде конечной разности.
Пусть поведение эпюры скорости с удалением от стенки известно.
То есть известна функция $u^{+} = f(y^{+})$.
Подберём такую модифицированную вязкость $\nu_w$,
при использовании которой совместно с конечноразностной аппроксимацией
нормальной производной, заданное распределение эпюры скорости $f$ сохраниться.
То есть
\begin{equation}
\label{tauw}
\tau_w = \nu_w  \frac{u_p - u_\gamma}{h},
\end{equation}
где $u_p$ -- значение касательной скорости в узле сетки, ближайшем к стенке,
$u_\gamma$ -- значение касательной скорости  на стенке (ноль при условии прилипания),
$h$ - нормальное расстояние от точки, в которой задана $u_p$ до стенки.

Комбинируя формулы \cref{utau,uy_plus,tauw}, отнесенные к точке, в которой $y=h, \, u=u_p$, выразим модифицированную вязкость

\begin{equation}
\label{nuw}
\nu_w = \nu\frac{h^{+}}{f(h^{+})}.
\end{equation}

Отметим, что формула \cref{nuw} может быть вычислена только итерационно.
Действительно, для вычисления $\nu_w$ нужно знать нормированное расстояние $h^{+}$, коэффициент нормировки которого зависит от $u_\tau$ через \cref{uy_plus}.
Скороть $u_\tau$ зависит от трения $\tau_w$, которое может быть вычислена только из \cref{tauw} с использованием $\nu_w$, $u_p$ с предыдущей итерации или временного слоя.
В качестве начального приближения можно взять $\nu_w = \nu$.

\subsection{Задание для самостоятельной работы}
В тесте \ename{[cavity-fvm]} из файла \ename{[cavity_fvm_test.cpp]}
реализована SIMPLE схема решения задачи о стационарном течении в каверне
методом конечных объёмов на регулярной сетке.

Необходимо дополнить программу алгоритмом коррекции коэффициента диффузии,
учитывающий логарифмическое поведение эпюры скорости при удалении от стенки.
Для этого использовать соотношение \cref{nuw} а в качестве $f(h^{+})$
использовать функцию с автоматической подстройкой:
\begin{equation*}
f(y^{+}) = \begin{cases}
y^{+},                         & h^{+} < 11.25,\\
\frac{1}{\kappa}\log(E y^{+}), & h^{+} > 11.25.
\end{cases}
\end{equation*}
\begin{equation*}
\kappa = 0.4187, \qquad E = 9.793.
\end{equation*}

После реализации нужно
\begin{itemize}
\item Настроить параметры счёта для достижения сходимости (уменьшить \cvar{eps})
\item Сравнить полученные поля скорости и давления в случае использования логарифмической пристеночной функции со случаем без неё (или тривиальной $f(y^{+}) = y^{+}$).
\item Так же сравнить значения суммарного трения: 
\begin{equation*}
   \tau = \int\limits_{\delta\Omega} \nu \dfr{u}{n} \, ds = \int\limits_{\delta\Omega} \nu_w \frac{u_\gamma - u_p}{h}\, ds.
\end{equation*}
\item Провести аналогичный тест с использованием неструктурированных pebi сеток.
\end{itemize}

\subsubsection{Рекомендации}
В алгоритм на итерационном слое (в самое его начало) необходимо добавить ещё один пункт:
вычисление коэффициента диффузии на гранях конечных объёмов.
Для внутренних граней он будет равен $\Ren^{-1}$,
а для граничных нужно применить формулу \cref{nuw}.
Далее найденные значения $\nu$ нужно использовать
вместо $\Ren^{-1}$ при сборке оператора Лапласа
в методе \cvar{assemble_u_lhs}.

Некоторые методы, которые могут быть полезны:
\begin{itemize}
\item Связность грань-ячейка: \cvar{IGrid::tab_face_cell}. Возвращает пару ячеек, первая из которых лежит против направления нормали.
      В случае, если с одной из сторон нет ячейки, на соответствующем месте будет стоять \cvar{INVALID_INDEX}.
      Это можно использовать для определения граничных граней.
\item Чистый список граничных граней можно получить из \cvar{IGrid::boundary_faces}.
\item Для расчёта нормальной к грани производной методом конечных объёмов по принципу
      $$\left.\dfr{f}{n}\right|_{ij} = \frac{f_{i} - f_{j}}{h_{ij}}$$
      можно использовать метод \cvar{FvmFacesDn::compute}.
\end{itemize}
